import{r as n,K as ee,j as e,I as i,M as c,F as t,O as se,S as te,ab as re,J as L}from"./index-mJfZwa4c.js";import{F as ae,i as ne}from"./index-BRtSp9Fa.js";import{P as le}from"./style-BQLjzlLm.js";import{A as k}from"./Alert-CdaVqFlA.js";import{I as ce}from"./InputGroup-CWufHJlC.js";import{T as oe}from"./Table-CslLgOAk.js";import{P as u}from"./Pagination-a2wk9ejN.js";import"./hook-1lnqU5U8.js";import"./Anchor-CQ_J7Lzo.js";import"./InputGroupContext-D1CbslUv.js";const Ne=()=>{const[N,y]=n.useState([]),[d,D]=n.useState(1),[de,M]=n.useState(0),[x,F]=n.useState(0),[p]=n.useState(13),[f,V]=n.useState(""),[B,C]=n.useState(!1),[O,j]=n.useState(!1),z=()=>j(!0),S=()=>j(!1),[v,g]=n.useState(!1);n.useState(!1),n.useState(!1);const[T,I]=n.useState(""),[w,h]=n.useState(""),[R,$]=n.useState(!1),[H,Z]=n.useState(!1),{control:J,handleSubmit:E,register:o,watch:K,formState:{errors:r}}=ee(),P=s=>{console.log(s),g(!0),fetch("https://lunarsenterprises.com:5016/crm/client/client_register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then(a=>a.json()).then(a=>{const{message:l,result:X}=a;X?(console.log("Success:",l),I(l),j(!1),m(),setTimeout(()=>I(""),5e3)):(console.error("Error:",l),h(l),setTimeout(()=>h(""),5e3)),g(!1)}).catch(a=>{console.error("Error:",a),h("An unexpected error occurred. Please try again."),setTimeout(()=>h(""),5e3),g(!1)})};K("password");const m=async(s=1,a="")=>{C(!0);try{const l=await L.post("https://lunarsenterprises.com:5016/crm/client/client_list",{page_no:s,limit:p,search:a});l.data.result===!0?(y(l.data.list),M(l.data.total_count),F(Math.ceil(l.data.total_count/p)),D(s)):(console.error(l.data.message),y([]))}catch(l){console.error("Error fetching products:",l)}finally{C(!1)}},b=s=>{s>0&&s<=x&&m(s,f)},W=s=>{V(s.target.value),m(1,s.target.value)};n.useEffect(()=>{m()},[]);const[Y,_]=n.useState(!1),[Q,G]=n.useState(null),A=s=>{G(s),_(!0)},q=()=>{_(!1),G(null)},U=async()=>{try{const s={u_id:Q},a=await L.post("https://lunarsenterprises.com:5016/crm/delete/reg",s);console.log(a),a.data.result===!0?(_(!1),m()):toast.error(a.data.message)}catch(s){console.error("Error fetching data:",s)}};return e.jsxs("div",{children:[e.jsx("div",{className:"item-manager",children:T&&e.jsx(k,{variant:"success",children:T})}),e.jsx("div",{className:"add-company mb-3",children:e.jsx(i,{variant:"success",className:"mb-3 ",onClick:z,children:"Client Register"})}),e.jsxs(c,{show:O,onHide:S,centered:!0,children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Add Company"})}),e.jsx(c.Body,{children:e.jsxs(t,{onSubmit:E(P),className:"+",children:[e.jsx("div",{className:"item-manager",children:w&&e.jsx(k,{variant:"danger",children:w})}),e.jsxs(t.Group,{className:"mb-2",controlId:"formCompanyName",children:[e.jsx(t.Label,{children:"Company Name"}),e.jsx(t.Control,{type:"text",placeholder:"Enter company name",...o("c_client_Companyname",{minLength:{value:3,message:"Minimum length is 3"},maxLength:{value:200,message:"Maximum length is 200"},pattern:{value:/^[A-Za-z\s]+$/,message:"Only letters and spaces are allowed"}})}),r.c_client_Companyname&&e.jsx("p",{className:"text-danger",children:r.c_client_Companyname.message})]}),e.jsxs(t.Group,{className:"mb-2",controlId:"formFullName",children:[e.jsx(t.Label,{children:"Client Name"}),e.jsx(t.Control,{type:"text",placeholder:"Enter full name",...o("c_clientname",{required:"Name is required",pattern:{value:/^[A-Za-z\s]+$/,message:"Only letters and spaces are allowed"}})}),r.c_clientname&&e.jsx("p",{className:"text-danger",children:r.c_clientname.message})]}),e.jsxs(t.Group,{className:"mb-2",controlId:"formFullName",children:[e.jsx(t.Label,{children:"Client Project Name"}),e.jsx(t.Control,{type:"text",placeholder:"Enter Project name",...o("c_clientproject_name",{required:"Name is required",pattern:{value:/^[A-Za-z\s]+$/,message:"Only letters and spaces are allowed"}})}),r.c_clientproject_name&&e.jsx("p",{className:"text-danger",children:r.c_clientproject_name.message})]}),e.jsxs(t.Group,{className:"mb-2",controlId:"formEmail",children:[e.jsx(t.Label,{children:"Email"}),e.jsx(t.Control,{type:"email",placeholder:"Enter email",...o("c_email",{required:"Email is required",pattern:{value:/^[^@\s]+@[^@\s]+\.[^@\s]+$/,message:"Invalid email address"}})}),r.c_email&&e.jsx("p",{className:"text-danger",children:r.c_email.message})]}),e.jsx(t.Label,{children:"GST and VAT (Optional)"}),e.jsx(t.Group,{className:"mb-2",controlId:"formGST",children:e.jsx(t.Check,{type:"checkbox",label:"GST",onChange:s=>$(s.target.checked)})}),R&&e.jsxs(t.Group,{className:"mb-2",controlId:"formGSTNumber",children:[e.jsx(t.Label,{children:"GST Number"}),e.jsx(t.Control,{type:"text",placeholder:"Enter GST number",...o("gst_number",{required:"GST number is required"})}),r.gst_number&&e.jsx("p",{className:"text-danger",children:r.gst_number.message})]}),e.jsx(t.Group,{className:"mb-2",controlId:"formVAT",children:e.jsx(t.Check,{type:"checkbox",label:"VAT",onChange:s=>Z(s.target.checked)})}),H&&e.jsxs(t.Group,{className:"mb-2",controlId:"formVATNumber",children:[e.jsx(t.Label,{children:"VAT Number"}),e.jsx(t.Control,{type:"text",placeholder:"Enter VAT number",...o("vat_number",{required:"VAT number is required"})}),r.vat_number&&e.jsx("p",{className:"text-danger",children:r.vat_number.message})]}),e.jsxs(t.Group,{className:"mb-2",controlId:"c_ph",children:[e.jsx(t.Label,{children:"Phone Number"}),e.jsx(se,{name:"c_ph",control:J,defaultValue:"",rules:{required:"Phone number is required"},render:({field:s})=>e.jsx(le,{...s,country:"in",inputStyle:{height:"40px",width:"100%"},placeholder:"Enter phone number"})}),r.c_ph&&e.jsx("p",{className:"text-danger",children:r.c_ph.message})]}),e.jsxs(t.Group,{className:"mb-2",controlId:"formFullName",children:[e.jsx(t.Label,{children:"Client Budget"}),e.jsx(t.Control,{type:"text",placeholder:"Enter Budget",...o("c_budget",{required:"Budget is required",pattern:{value:/^[0-9]+(\.[0-9]{1,2})?$/,message:"Only numbers and a decimal point are allowed (max two decimals)"}})}),r.c_budget&&e.jsx("p",{className:"text-danger",children:r.c_budget.message})]}),e.jsxs(t.Group,{className:"mb-2",controlId:"c_date",children:[e.jsx(t.Label,{children:"Project Date"}),e.jsx(t.Control,{type:"date",placeholder:"Enter Project  closing Date",...o("c_date",{required:"Date is required"})}),r.c_date&&e.jsx("p",{className:"text-danger",children:r.c_date.message})]}),e.jsxs(t.Group,{className:"mb-2",controlId:"c_project_deliverydate",children:[e.jsx(t.Label,{children:"Project Date"}),e.jsx(t.Control,{type:"date",placeholder:"Enter Project Delivery Date",...o("c_project_deliverydate",{required:"Date is required"})}),r.c_project_deliverydate&&e.jsx("p",{className:"text-danger",children:r.c_project_deliverydate.message})]})]})}),e.jsxs(c.Footer,{children:[e.jsx(i,{variant:"secondary",onClick:S,children:"Close"}),e.jsx(i,{variant:"primary",type:"submit",onClick:E(P),className:"d-flex align-items-center",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(te,{animation:"border",size:"sm",className:"me-2"}),"Registering..."]}):"Register"})]})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-6",children:e.jsx(ce,{className:"",children:e.jsx(re,{placeholder:"Search products...",value:f,onChange:W})})})}),e.jsxs("div",{children:[e.jsxs(oe,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"mt-4",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Company Name"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Project Name"}),e.jsx("th",{children:"Gst Number/Vat Number"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"Budget"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"})]})}),e.jsx("tbody",{children:B?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center",children:"Loading..."})}):N.length>0?N.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:(d-1)*p+a+1}),e.jsx("td",{children:s.c_client_Companyname||"Lunar"}),e.jsx("td",{children:s.c_clientname||"ABC"}),e.jsx("td",{children:s.c_clientproject_name||"Website"}),e.jsx("td",{children:s.gst_number||s.vat_number||"1234567890"}),e.jsx("td",{children:s.c_email||"lunar@gmail.com"}),e.jsx("td",{children:s.c_ph||"047122334455"}),e.jsx("td",{children:s.c_budget||"45000"}),e.jsx("td",{children:s.c_date||"01/01/2025"}),e.jsx("td",{children:s.c_project_deliverydate||"05/03/2025"}),e.jsx("td",{className:"btn-deleteview",children:e.jsx(i,{className:"btn-deletelist",variant:"danger",size:"sm",onClick:l=>{l.stopPropagation(),A(s.u_id)},children:e.jsx(ae,{icon:ne,size:"sm",color:"red",style:{cursor:"pointer"},onClick:l=>{l.stopPropagation(),A(s.u_id)}})})})]},s.i_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center",children:"No products found"})})})]}),e.jsx("div",{className:"centree",children:e.jsxs(u,{children:[e.jsx(u.Prev,{onClick:()=>b(d-1),disabled:d===1}),e.jsx("div",{className:"paginationaldes",children:Array.from({length:x},(s,a)=>e.jsx(u.Item,{active:a+1===d,onClick:()=>b(a+1),children:a+1},a+1))}),e.jsx(u.Next,{onClick:()=>b(d+1),disabled:d===x})]})})]}),e.jsxs(c,{show:Y,onHide:q,children:[e.jsx(c.Header,{closeButton:!0,children:e.jsx(c.Title,{children:"Confirm Deletion"})}),e.jsx(c.Body,{children:"Are you sure you want to delete this Company?"}),e.jsxs(c.Footer,{children:[e.jsx(i,{variant:"secondary",onClick:q,children:"No"}),e.jsx(i,{variant:"danger",onClick:U,children:"Yes, Delete"})]})]})]})};export{Ne as default};
